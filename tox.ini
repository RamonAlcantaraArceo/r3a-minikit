[tox]
isolated_build = true
env_list = py310,py311,py312,py313,py314,format,lint-only

labels =
    tests = py310, py311, py312, py313, py314 
    style = format, lint-only

[testenv]
allowlist_externals = poetry
commands_pre =
    poetry install --with dev
commands =
    poetry run pytest --cov=src --cov-report=term-missing --cov-report=xml --junitxml=junit.xml

[testenv:py310]
description = Run tests with Python 3.10
basepython = python3.10

[testenv:py311]
description = Run tests with Python 3.11
basepython = python3.11

[testenv:py312]
description = Run tests with Python 3.12
basepython = python3.12

[testenv:py313]
description = Run tests with Python 3.13
basepython = python3.13

[testenv:py314]
description = Run tests with Python 3.14
basepython = python3.14

[testenv:test-all]
description = Run all Python versions in parallel
deps = tox
commands = tox -p auto

[testenv:format]
description = Auto-format code with Ruff
basepython = python3.14
commands =
    poetry run ruff format

[testenv:lint-only]
description = Run linting and type checking only
basepython = python3.14
commands =
    poetry run ruff check src/ tests/
    poetry run mypy src/ tests/